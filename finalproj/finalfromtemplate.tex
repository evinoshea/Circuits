% Template for ICME-2015 paper; to be used with:
%          spconf.sty  - ICASSP/ICIP LaTeX style file, and
%          IEEEbib.bst - IEEE bibliography style file.
% --------------------------------------------------------------------------
\documentclass{article}
\usepackage{spconf,amsmath,epsfig, url}

\pagestyle{empty}


\begin{document}\sloppy

% Example definitions.
% --------------------
\def\x{{\mathbf x}}
\def\L{{\cal L}}


% Title.
% ------
\title{The Constrution of a Music Visualizer}
%
% Single address.
% ---------------

\name{Morgan A. Daly}
\name{Evin O'Shea}

\address{}


\maketitle


%REFER TO "THINGS MARC SAID" 2c to see outline of project
%figure placement sucks as it is to be on the top of the page, will have to adjust again after amkign the abstract
\begin{abstract}

\end{abstract}
%
\begin{keywords}
One, two, three, four, five
\end{keywords}
%
\section{Introduction}
\label{sec:intro}

The goal of the project was to build a simple music visualizer. The visualizer would have lights that would activate when sound was played in low, mid, and high frequency ranges. The visualizer would use a microphone and amplifiers to power the lights.

\section{Design}
The visualizer took input from a simple microphone. The microphone came with a design circuit that was meant to be used as a basic high pass filter. The output from the microphone was sent to an amplifier to increase both the voltage output and the power output of the microphone. This amplifier was made with an op-amp that had just an input resistor and a feedback resistor as shown in figure (1).


This made the magnitude of the gain of the amplifier the ratio of the resistors.

\begin{eqnarray}
Gain &=& -\frac{R_F}{R_{in}} \nonumber \\
|G| &=& \frac{R_F}{R_{in}} 
\end{eqnarray}

The benefit of having two stages of amplification is that the output of the first amplifier could be mirrored with an AC voltage supply. This made testing the second stage of the circuit simple as the AC voltage could be set equal to the expected output of the amplifier and then the frequency of the AC supply could be varied to test the effectiveness of the filters. 

The output of the first amplifier was then sent to three different filters and amplifiers. Each of these corresponded to a different piece of the sound spectrum: low, middle, and high. Each of the filters used are second order filters. This means that they have second order roll off. This is important for the visualizer as the filters have to be good enough to only allow voltage through in the frequency spectrum desired. If the roll off were not good enough, loud sounds in on frequency spectrum could potentially cause an effect in another frequency spectrum. 

The low frequency was captured by using the second stage filter shown in figure (2).~\cite{Low}

The gain of this filter could be calculated as shown below~\cite{Low}:

\begin{eqnarray}
Gain &=& 1 + \frac{R_2}{R_1} 
\end{eqnarray}

Furthermore, the -3dB point could be calculated as shown below~\cite{Low}:

\begin{eqnarray}
f_C &=& \frac{1}{2\pi \sqrt{R_3R_4C_1C_2}}
\end{eqnarray}

Since these two relations do not have overlapping circuit elements, the gain and spectrum of the filter could be adjusted independently. This meant that after a maximum frequency was selected and the gain was be determined by the output of the first filter, the values for the elements could be calculated just with these formulae. 

\begin{figure}[t]

\begin{minipage}[b]{1.0\linewidth}
  \centering
  \centerline{\epsfig{figure=amp.png,width=8.5cm}}
\caption{The Basic Amplifier}
\end{minipage}
\begin{minipage}[b]{1.0\linewidth}
  \centering
  \centerline{\epsfig{figure=lowpass.png,width=8.5cm}}
\caption{The Low Pass Filter}
\end{minipage}
\end{figure}

The high pass filter used acted very similarly to the low pass filter. It was also a second stage filter that had both the capability of filtering and amplifying a signal independently. The circuit used is shown in figure (3).~\cite{High}

The gain of this filter could be calculated as shown below~\cite{High}:

\begin{eqnarray}
Gain &=& 1 + \frac{R_2}{R_1} 
\end{eqnarray}

Furthermore, the -3dB point could be calculated as shown below~\cite{High}:

\begin{eqnarray}
f_C &=& \frac{1}{2\pi \sqrt{R_3R_4C_1C_2}}
\end{eqnarray}

As with the low pass filter, the nature of the high pass filter and the gain could be set independently, making this circuit ideal for use for the visualizer.

\begin{figure}
\begin{minipage}[b]{1.0\linewidth}
  \centering
  \centerline{\epsfig{figure=highpass.png,width=8.5cm}}
\caption{The Basic Amplifier}
\end{minipage}

\end{figure}

The band pass filter used in the circuit also had second order roll off. The flaw with this filter was that the width of the band and the gain of the filter were intrinsically tided. This problem was solved by adding another amplifier before the filter. The amplifier that came before the filter is the same one that was used for the output of the microphone that is shown in figure (1). This amplifier had different resistor values and a different gain. The output of this amplifier was then sent to the band pass filter shown in figure (4).~\cite{Band}



The middle frequency of the band can be calculated with the equation shown below~\cite{Band}:

\begin{eqnarray}
f_C &=& \frac{1}{2\pi \sqrt{R_1R_2C_1C_2}}
\end{eqnarray}

The width of the band pass filter is the distance between the low -3dB point and the high -3dB point. This can be calculated as shown below~\cite{Band}:

\begin{eqnarray}
Q_{BP} = \frac{1}{2}\sqrt{\frac{R_2}{R_1}}
\end{eqnarray}


The problem is that the gain of the filter is given from the equation below:

\begin{eqnarray}
Gain = -\frac{R_2}{2R_1} = -2Q^2
\end{eqnarray}

This meant that after selecting a desired range for the band pass filter, the gain was set. 

Lastly, all of the filters needed to output 2 volts or greater to light the LED’s. This meant that there was a minimum sound level that was needed to activate the visualizer. This also meant that the gain of each filter was adjusted to make the final output to be around 2 volts.
\begin{figure}
\begin{minipage}[b]{1.0\linewidth}
  \centering
  \centerline{\epsfig{figure=bandpass.png,width=8.5cm}}
\caption{The Basic Amplifier}
\end{minipage}

\end{figure}



\section{Test Results}



\section{Analysis}



\section{Conclusion}
The visualizer was complete, but was very sensitive to the music being played. The effect for low frequencies was hard to fine tune as bass is output is often less intense than middle frequencies. The speakers available during testing did not have powerful bass output. This meant that to get the low frequency light to work, the gain of the low pass filter had to be much greater than that of the other filters.
 
The band pass filter worked very well, only frequencies in the desired range caused the light to respond.

The high pass filter also worked well as the gain built into the filter was easy to adjust to cause the high frequency effect.




%this stuff is for formating and should be deleted later:

% Below is an example of how to insert images. Delete the ``\vspace'' line,
% uncomment the preceding line ``\centerline...'' and replace ``imageX.ps''
% with a suitable PostScript file name.
% -------------------------------------------------------------------------
%
\begin{figure}[t]
\begin{minipage}[b]{1.0\linewidth}
  \centering
% \centerline{\epsfig{figure=image1.ps,width=8.5cm}}
  \vspace{1.5cm}
  \centerline{(a) Result 1}\medskip
\end{minipage}
%
\begin{minipage}[b]{.48\linewidth}
  \centering
% \centerline{\epsfig{figure=image3.ps,width=4.0cm}}
  \vspace{1.5cm}
  \centerline{(b) Results 2}\medskip
\end{minipage}
\hfill
\begin{minipage}[b]{0.48\linewidth}
  \centering
% \centerline{\epsfig{figure=image4.ps,width=4.0cm}}
  \vspace{1.5cm}
  \centerline{(c) Result 3}\medskip
\end{minipage}
%
\caption{Example of placing a figure with experimental results.}
\label{fig:res}
\end{figure}



\section{Illustrations, Graphs, and Photographs}
\label{sec:illust}

Illustrations must appear within the designated margins. They may span the two columns. If possible, position illustrations at the top of columns, rather than in the middle or at the bottom. Caption and number every illustration. All halftone illustrations must be clear black and white prints.  Do not use any colors in illustrations.

Since there are many ways, often incompatible, of including images (e.g., with experimental results) in a \LaTeX document. Figure~\ref{fig:res} shows you an example of how to do this.

\section{Tables and Equations}

\begin{eqnarray}
y &=& ax^2+bx+c \nonumber \\
~ &=& (x+p)(x+q)
\end{eqnarray}
shows an example of an equation layout.

\begin{table}[t]
\begin{center}
\caption{Table caption} \label{tab:cap}
\begin{tabular}{|c|c|c|}
  \hline
  % after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
  Column One & Column Two & Column Three
  \\
  \hline
  Cell 1 & Cell 2 & Cell 3 \\
  Cell 4 & Cell 5 & Cell 6 \\
  \hline
\end{tabular}
\end{center}
\end{table}



\section{Citations and References}

List and number all bibliographical references at the end of the paper. The references can be numbered in alphabetic order or in order of appearance in the document. When referring to them in the text, type the corresponding reference number in square brackets as shown at the end of this sentence. All citations must be adhered to IEEE format and style. 

% References should be produced using the bibtex program from suitable
% BiBTeX files (here: strings, refs, manuals). The IEEEbib.bst bibliography
% style file from IEEE produces unsorted bibliography list.
% -------------------------------------------------------------------------
\bibliographystyle{IEEEbib}
\bibliography{phys605final}

\end{document}
